syntax = "proto3";

package echo;

option go_package = "github.com/tsaarni/echoserver/proto";

service EchoService {
  rpc Echo(EchoRequest) returns (EchoResponse);
  rpc EchoCountdown(EchoCountdownRequest) returns (stream EchoCountdownResponse);
}

message EchoRequest {
  string message = 1;
}

message EchoResponse {
  string message = 1;
  map<string, HeaderValues> headers = 2;
  string remote_addr = 3;
  TLSInfo tls_info = 4;
  map<string, string> env = 5;
}

message HeaderValues {
  repeated string values = 1;
}

message TLSInfo {
  string version = 1;
  string cipher_suite = 2;
  string alpn_negotiated_protocol = 3;
  repeated TLSCertificateInfo peer_certificates = 4;
}

message TLSCertificateInfo {
  string subject = 1;
  string issuer = 2;
  string serial_number = 3;
  string not_before = 4;
  string not_after = 5;
}

message EchoCountdownRequest {
  int32 start = 1;
}

message EchoCountdownResponse {
  int32 count = 1;
}
